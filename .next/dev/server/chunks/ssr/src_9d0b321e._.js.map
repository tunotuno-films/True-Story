{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/utils/authUtils.ts"],"sourcesContent":["import { supabase } from '../lib/supabaseClient';\n\nexport const generateYears = () => {\n  const currentYear = new Date().getFullYear();\n  const years = [];\n  for (let year = currentYear; year >= currentYear - 100; year--) {\n    years.push(year);\n  }\n  return years;\n};\n\nexport const generateMonths = () => {\n  return Array.from({ length: 12 }, (_, i) => i + 1);\n};\n\nexport const generateDays = (year?: string, month?: string) => {\n  if (!year || !month) return Array.from({ length: 31 }, (_, i) => i + 1);\n  \n  const lastDay = new Date(parseInt(year), parseInt(month), 0).getDate();\n  return Array.from({ length: lastDay }, (_, i) => i + 1);\n};\n\nexport const formatBirthDate = (year?: string, month?: string, day?: string) => {\n  if (!year || !month || !day) return '';\n  const formattedMonth = month.padStart(2, '0');\n  const formattedDay = day.padStart(2, '0');\n  return `${year}-${formattedMonth}-${formattedDay}`;\n};\n\nexport const calculatePasswordStrength = (password: string): { strength: number; message: string } => {\n  if (!password) return { strength: 0, message: '' };\n\n  let score = 0;\n  \n  if (password.length >= 8) score += 1;\n  if (password.length >= 12) score += 1;\n  if (/[A-Z]/.test(password)) score += 1;\n  if (/[a-z]/.test(password)) score += 1;\n  if (/[0-9]/.test(password)) score += 1;\n  if (/[^A-Za-z0-9]/.test(password)) score += 1;\n  \n  const normalizedScore = Math.min(3, Math.floor(score / 2));\n  \n  let message = '';\n  if (normalizedScore === 0) message = '弱いパスワード';\n  else if (normalizedScore === 1) message = '普通のパスワード';\n  else if (normalizedScore === 2) message = '強いパスワード';\n  else message = '非常に強いパスワード';\n  \n  return { strength: normalizedScore, message };\n};\n\nexport const checkMemberExists = async (userId: string) => {\n  try {\n    // まず個人ユーザーテーブルをチェック\n    const { data: individualMember } = await supabase\n      .from('individual_members')\n      .select('*')\n      .eq('auth_user_id', userId)\n      .limit(1)\n      .maybeSingle();\n\n    if (individualMember) {\n      return { ...individualMember, user_type: 'individual' };\n    }\n\n    // 次に企業ユーザーテーブルをチェック\n    const { data: sponsorMember } = await supabase\n      .from('sponsor_members')\n      .select('*')\n      .eq('auth_user_id', userId)\n      .limit(1)\n      .maybeSingle();\n\n    if (sponsorMember) {\n      return { ...sponsorMember, user_type: 'sponsor' };\n    }\n\n    return null;\n  } catch (error) {\n    console.error('Error in checkMemberExists:', error);\n    return null;\n  }\n};\n\nexport const getRedirectURL = () => {\n  // 1) ローカル開発用に明示的な env を優先（.env.local に設定してください）\n  if (typeof process !== 'undefined' && process?.env?.REACT_APP_SITE_URL) {\n    return String(process.env.REACT_APP_SITE_URL).replace(/\\/$/, '');\n  }\n\n  // 2) Next.js の process.env をチェック\n  if (typeof process !== 'undefined' && process?.env?.NEXT_PUBLIC_SITE_URL) {\n    return String(process.env.NEXT_PUBLIC_SITE_URL).replace(/\\/$/, '');\n  }\n\n  // 3) ブラウザ実行時かつローカルホストなら現在の origin を最優先（ポートも含む）\n  if (typeof window !== 'undefined' && window.location && window.location.hostname) {\n    const hostname = window.location.hostname;\n    const origin = String(window.location.origin).replace(/\\/$/, '');\n    if (\n      hostname.includes('localhost') ||\n      hostname.startsWith('127.') ||\n      hostname === '::1'\n    ) {\n      return origin;\n    }\n  }\n\n  // 4) 最後のフォールバックは本番URL\n  return 'https://www.truestory.jp';\n};\n\nexport const handleGoogleAuth = async () => {\n  const base = getRedirectURL();\n  const redirectTo = `${base.replace(/\\/$/, '')}/users`; // 認証後は /users に戻す\n\n  // デバッグログを強化：Supabase に渡す redirectTo を明示表示します\n  console.info('[authUtils] Google auth redirectTo ->', redirectTo);\n\n  try {\n    const { error } = await supabase.auth.signInWithOAuth({\n      provider: 'google',\n      options: {\n        redirectTo: redirectTo,\n        queryParams: {\n          prompt: 'select_account'\n        }\n      }\n    });\n\n    if (error) {\n      console.error('Google auth error:', error);\n    }\n  } catch (err) {\n    console.error('Unexpected error during Google auth:', err);\n  }\n};\n\n// 追加: 冗長なサインアウト処理を共通化\nexport const robustSignOut = async () => {\n  try {\n    const { error } = await supabase.auth.signOut();\n    if (error) {\n      console.warn('Supabase signOut returned error:', error);\n      // ここではエラーをそのまま続行してフォールバック処理へ進める\n    }\n  } catch (err) {\n    console.warn('Supabase signOut threw error:', err);\n    // 続行してフォールバック処理へ\n  } finally {\n    // localStorage はブラウザ環境でのみ利用可能なため、存在チェックを行う\n    if (typeof window !== 'undefined' && window.localStorage) {\n      try {\n        Object.keys(window.localStorage).forEach((k) => {\n          const key = String(k);\n          const lower = key.toLowerCase();\n          // supabase-js v2 uses keys like \"sb-<project_ref>-auth-token\"\n          // older versions used \"supabase.\" prefix. Remove either.\n          if (lower.startsWith('sb-') || lower.startsWith('supabase.')) {\n            window.localStorage.removeItem(key);\n          }\n        });\n      } catch (e) {\n        console.warn('Failed to clear supabase localStorage items.', e);\n      }\n    }\n\n    // The redirect fallback was removed because it was causing a 405 error\n    // by making a GET request to a POST-only endpoint.\n    // supabase.auth.signOut() should be sufficient.\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/components/PrivacyPolicy.tsx"],"sourcesContent":["import React from 'react';\n\ninterface PrivacyPolicyProps {\n  onClose: () => void;\n}\n\nconst PrivacyPolicy: React.FC<PrivacyPolicyProps> = ({ onClose }) => {\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-95 z-[100] p-4 sm:p-8 md:p-12 overflow-y-auto\">\n      <div className=\"container mx-auto max-w-4xl text-neutral-300 font-noto text-xs md:text-sm\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-2xl md:text-3xl font-bold text-white\">個人情報保護（プライバシーポリシー）</h1>\n          <button onClick={onClose} className=\"text-gray-400 hover:text-white text-3xl\">&times;</button>\n        </div>\n        <div className=\"space-y-4 md:space-y-6 leading-relaxed\">\n\n          <p>\n            True Story【実話の物語】（以下「当社」といいます）は、制作活動および会員サービス（会員マイページを含む）を提供する上で\n            取扱うお客様・お取引先様・従業員等の個人情報を適切に保護することを社会的責務と認識し、以下の方針に基づき個人情報の保護に努めます。\n          </p>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">1. 個人情報の定義</h2>\n            <p>\n              本方針において「個人情報」とは、個人情報保護法に定められた定義に従い、氏名、生年月日、住所、電話番号、メールアドレス、\n              勤務先、ログインID、パスワード、利用履歴その他特定の個人を識別できるもの、ならびに他の情報と照合することで個人を識別できるものを指します。\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">2. 個人情報の取得方法</h2>\n            <p>\n              当社は、以下の方法で個人情報を取得します。\n            </p>\n            <ul className=\"list-disc list-inside ml-4 mt-2 space-y-1\">\n              <li>会員登録フォームや会員マイページでの入力</li>\n              <li>ウェブサイトやメールフォーム、電話、書面等を通じた直接取得</li>\n              <li>イベント、セミナー、アンケート等での取得</li>\n              <li>業務委託先や取引先等から適法に提供を受けた場合</li>\n              <li>公表された情報から適法に収集する場合</li>\n            </ul>\n            <p className=\"mt-2\">取得の際には、利用目的を明確にし、適法かつ公正な手段で行います。</p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">3. 個人情報の利用目的</h2>\n            <p>当社は、取得した個人情報を以下の目的で利用します。</p>\n            <ul className=\"list-disc list-inside ml-4 mt-2 space-y-1\">\n              <li>サービスや商品の提供および契約履行</li>\n              <li>会員登録、本人認証、会員マイページ機能の提供・管理</li>\n              <li>会員向けサービス（履歴表示、ポイント、カスタマイズ機能等）の運営</li>\n              <li>退会手続きおよび退会後の記録管理</li>\n              <li>お問い合わせやご依頼への対応</li>\n              <li>契約、取引、請求、支払い等の事務処理</li>\n              <li>メールマガジン、ニュースレター、イベント案内等の送付</li>\n              <li>アンケート調査、モニター募集等の実施</li>\n              <li>法令や契約に基づく権利の行使または義務の履行</li>\n              <li>防犯・安全管理のための記録・監視</li>\n              <li>その他、事前に本人の同意を得た目的</li>\n            </ul>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">4. 個人情報の第三者提供</h2>\n            <p>\n              当社は、以下の場合を除き、本人の同意なく第三者に個人情報を提供しません。\n            </p>\n            <ul className=\"list-disc list-inside ml-4 mt-2 space-y-1\">\n              <li>法令に基づく場合</li>\n              <li>人の生命、身体または財産の保護のために必要で、本人の同意を得ることが困難な場合</li>\n              <li>公衆衛生の向上または児童の健全な育成推進のために特に必要な場合で、本人の同意を得ることが困難な場合</li>\n              <li>国の機関や地方公共団体等が法令の定める事務を遂行するために協力する必要がある場合</li>\n              <li>業務委託先に必要な範囲で提供する場合（委託先は適切に監督します）</li>\n            </ul>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">5. 個人情報の委託</h2>\n            <p>\n              当社は、事業運営に必要な範囲で業務を外部に委託する場合、委託先が個人情報を適切に取り扱うよう契約等により義務付け、\n              必要かつ適切な監督を行います。\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">6. 個人情報の安全管理措置</h2>\n            <p>\n              当社は、個人情報の漏えい、滅失、毀損、不正アクセス等を防止するため、以下の安全管理措置を講じます。\n            </p>\n            <ul className=\"list-disc list-inside ml-4 mt-2 space-y-1\">\n              <li>個人情報管理責任者の設置</li>\n              <li>個人情報の利用制限とアクセス権限の管理</li>\n              <li>パスワードや暗号化等の技術的対策</li>\n              <li>社員教育や内部監査の実施</li>\n              <li>保管期限を過ぎた個人情報の適切な廃棄・消去</li>\n            </ul>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">7. クッキー（Cookie）およびローカルストレージ等の利用</h2>\n            <p>\n              当社ウェブサイトおよび会員マイページでは、利便性向上やアクセス解析等のために Cookie や類似技術を使用する場合があります。\n              これにより取得される情報は、個人を特定するものではなく、設定により使用を制限できます。必要に応じて、Google Analytics 等の外部サービスを利用することがあります。\n            </p>\n            <p className=\"mt-2\">\n              また、会員マイページにおいては、ログイン状態の保持、表示設定の保存、利用状況の記録等のために、ブラウザの\n              ローカルストレージ（LocalStorage・SessionStorage）を利用する場合があります。ローカルストレージに保存される情報は、\n              利用者の端末上でのみ保持され、当社サーバーに自動的に送信されることはありません。\n            </p>\n            <p className=\"mt-2\">\n              利用者は、ご自身のブラウザ設定により、Cookieやローカルストレージの使用を制限または削除することができます。ただし、\n              その場合、会員マイページの一部機能が正しく利用できない可能性があります。\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">8. 個人情報の開示・訂正・利用停止等</h2>\n            <p>\n              本人または代理人から、当社が保有する個人情報の開示・訂正・追加・削除・利用停止・第三者提供停止の請求があった場合は、\n              法令に従い適切かつ速やかに対応します。請求の際には、本人確認のための書類提出をお願いする場合があります。\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">9. 未成年の会員情報について</h2>\n            <p>\n              16歳未満の方が会員登録を行う場合は、必ず保護者の同意を得てください。当社は、保護者の同意が確認できない場合、\n              会員サービスを提供できないことがあります。\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">10. 法令・規範の遵守</h2>\n            <p>\n              当社は、個人情報の取扱いに関して適用される法令、国が定める指針、その他の規範を遵守します。\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">11. 継続的改善</h2>\n            <p>\n              当社は、個人情報保護のための管理体制や取組を継続的に見直し、改善します。\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">12. お問い合わせ窓口</h2>\n            <p>\n              本方針および個人情報の取扱いに関するお問い合わせは、以下の窓口までお願いします。<br />\n              True Story【実話の物語】<br />\n              電話番号：090-9646-8942 （代表）<br />\n              メールアドレス：info@truestory.jp<br />\n              受付時間：平日 11:00〜19:00（土日祝・年末年始を除く）\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-white mb-2\">13. 制定日・改訂日</h2>\n            <p>制定日：2025年08月01日<br />改訂日：2025年09月13日</p>\n          </section>\n        </div>\n        <div className=\"text-center mt-8 md:mt-12\">\n          <button onClick={onClose} className=\"bg-white text-black font-bold py-3 px-8 rounded-full hover:opacity-90 transition-opacity duration-300 text-lg\">\n            閉じる\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PrivacyPolicy;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 823, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/components/CookieConsent.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PrivacyPolicy from './PrivacyPolicy';\n\nconst CookieConsent: React.FC = () => {\n  const [showBanner, setShowBanner] = useState(false);\n  const [showPrivacy, setShowPrivacy] = useState(false);\n\n  useEffect(() => {\n    const consent = localStorage.getItem('cookie_consent');\n    if (consent !== 'dismissed') {\n      setShowBanner(true);\n    }\n  }, []);\n\n  const handleDismiss = () => {\n    localStorage.setItem('cookie_consent', 'dismissed');\n    setShowBanner(false);\n  };\n\n  if (!showBanner) {\n    return null;\n  }\n\n  return (\n    <>\n      <div className=\"fixed bottom-0 left-0 right-0 bg-gray-800 text-white p-4 z-50\">\n        <div className=\"container mx-auto flex flex-col md:flex-row justify-between items-center gap-3\">\n          <p className=\"text-sm\">\n            当サイトでは、ログイン機能などサービスの提供に必須のCookieを使用しています。サイトの利用を継続することで、これらのCookieの使用に同意したものとみなされます。\n            詳細は\n            <button\n              type=\"button\"\n              onClick={() => setShowPrivacy(true)}\n              className=\"underline ml-1\"\n            >\n              プライバシーポリシー\n            </button>\n            をご確認ください。\n          </p>\n          <div className=\"flex items-center gap-3\">\n            <button\n              onClick={handleDismiss}\n              className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\n              aria-label=\"閉じる\"\n            >\n              OK\n            </button>\n          </div>\n        </div>\n      </div>\n      {showPrivacy && <PrivacyPolicy onClose={() => setShowPrivacy(false)} />}\n    </>\n  );\n};\n\nexport default CookieConsent;\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEA,MAAM,gBAA0B;IAC9B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAE/C,IAAA,kNAAS,EAAC;QACR,MAAM,UAAU,aAAa,OAAO,CAAC;QACrC,IAAI,YAAY,aAAa;YAC3B,cAAc;QAChB;IACF,GAAG,EAAE;IAEL,MAAM,gBAAgB;QACpB,aAAa,OAAO,CAAC,kBAAkB;QACvC,cAAc;IAChB;IAEA,IAAI,CAAC,YAAY;QACf,OAAO;IACT;IAEA,qBACE;;0BACE,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAE,WAAU;;gCAAU;8CAGrB,8OAAC;oCACC,MAAK;oCACL,SAAS,IAAM,eAAe;oCAC9B,WAAU;8CACX;;;;;;gCAEQ;;;;;;;sCAGX,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCACC,SAAS;gCACT,WAAU;gCACV,cAAW;0CACZ;;;;;;;;;;;;;;;;;;;;;;YAMN,6BAAe,8OAAC,8IAAa;gBAAC,SAAS,IAAM,eAAe;;;;;;;;AAGnE;uCAEe","debugId":null}},
    {"offset": {"line": 920, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/components/Header.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { supabase } from '../lib/supabaseClient';\nimport { Menu, X } from 'lucide-react';\nimport CookieConsent from './CookieConsent';\nimport { useAuth } from '../contexts/AuthContext';\n\ninterface Vote {\n  message: string | null;\n  voter_name: string | null;\n}\n\ninterface NavItem {\n  id?: string;\n  path?: string;\n  label: string;\n}\n\nconst Header: React.FC = () => {\n  const router = useRouter();\n  const pathname = usePathname();\n  const { session } = useAuth();\n  const isLoggedIn = !!session;\n\n  const [latestVotes, setLatestVotes] = useState<Vote[]>([]);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const animationRef = useRef<HTMLDivElement>(null);\n  const [applyWillChange, setApplyWillChange] = useState(false);\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);\n\n  const fetchLatestVotes = useCallback(async () => {\n    const { data, error } = await supabase\n      .from('votes')\n      .select('message, voter_name')\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error fetching latest votes:', error);\n    } else {\n      setLatestVotes(data || []);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchLatestVotes();\n  }, [fetchLatestVotes]);\n\n  const handleAnimationIteration = () => {\n    fetchLatestVotes();\n  };\n\n  const scrollToSection = (sectionId: string) => {\n    if (pathname !== '/') {\n      router.push(`/#${sectionId}`);\n    } else {\n      const element = document.getElementById(sectionId);\n      if (element) {\n        element.scrollIntoView({ behavior: 'smooth' });\n      }\n    }\n  };\n\n  const handleMobileLinkClick = (sectionId: string) => {\n    scrollToSection(sectionId);\n    setIsMenuOpen(false);\n  };\n\n  const scrollToTop = () => {\n    if (pathname !== '/') {\n      router.push('/');\n    } else {\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n  };\n\n  const navItems: NavItem[] = [\n    // { path: '/about', label: 'ABOUT' },\n    { id: 'truestoryform', label: 'TRUE STORY' },\n    { id: 'artist', label: 'ARTIST' },\n    { id: 'crowdfunding', label: 'CROWDFUNDING' },\n    { id: 'contact', label: 'CONTACT' },\n  ];\n\n  const handleMyPageClick = () => {\n    router.push('/users');\n  };\n\n  // ログイン中はマイページへ遷移、未ログイン時はメンバーシップへ\n  const handleAuthButtonClick = () => {\n    if (isLoggedIn) {\n      const userId = session?.user?.id;\n      if (userId) {\n        router.push(`/users/member/${userId}`);\n        return;\n      }\n      // fallback: メンバーシップ画面へ（session が取れない場合）\n      handleMyPageClick();\n    } else {\n      handleMyPageClick();\n    }\n  };\n\n  useEffect(() => {\n    const mq = window.matchMedia('(prefers-reduced-motion: reduce)');\n    const update = () => setPrefersReducedMotion(mq.matches);\n    update();\n    mq.addEventListener?.('change', update);\n    return () => mq.removeEventListener?.('change', update);\n  }, []);\n\n  useEffect(() => {\n    const el = animationRef.current;\n    if (!el) return;\n\n    const observer = new IntersectionObserver(\n      ([entry]) => {\n        setApplyWillChange(entry.isIntersecting && !prefersReducedMotion && latestVotes.length > 0);\n      },\n      { root: null, threshold: 0.1 }\n    );\n\n    observer.observe(el);\n    return () => observer.disconnect();\n  }, [latestVotes.length, prefersReducedMotion]);\n\n  return (\n    <>\n      <header className=\"sticky top-0 z-50\">\n        <nav className=\"bg-black\">\n          <div className=\"container mx-auto px-4\">\n            <div className=\"flex items-center justify-between h-16\">\n              <div\n                className=\"text-white font-noto text-xl font-bold cursor-pointer\"\n                onClick={scrollToTop}\n              >\n                True Story【実話の物語】\n              </div>\n              \n              <div className=\"hidden xl_custom:flex items-center space-x-4 md:space-x-8\">\n                {navItems.map((item) => (\n                  <button\n                    key={item.label}\n                    onClick={() => {\n                      if (item.path) {\n                        router.push(item.path);\n                      } else if (item.id) {\n                        scrollToSection(item.id);\n                      }\n                    }}\n                    className=\"text-neutral-300 hover:text-white transition duration-300 font-noto\"\n                  >\n                    {item.label}\n                  </button>\n                ))}\n                <button\n                  onClick={handleAuthButtonClick}\n                  className=\"text-white transition duration-300 font-noto px-2 py-1 border border-transparent hover:opacity-90\"\n                >\n                  <span className=\"inline-block bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-bold py-2 px-4 rounded\">\n                   {isLoggedIn ? 'マイページ' : 'メンバーシップ'}\n                  </span>\n                </button>\n              </div>\n\n              <div className=\"xl_custom:hidden\">\n                <button onClick={() => setIsMenuOpen(!isMenuOpen)} className=\"text-white\">\n                  {isMenuOpen ? <X size={28} /> : <Menu size={28} />}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <div \n            className={`xl_custom:hidden bg-black/95 backdrop-blur-md absolute w-full z-40 shadow-lg border-t border-gray-700 transition-all duration-300 ease-in-out transform origin-top ${\n              isMenuOpen \n                ? 'opacity-100 scale-y-100 translate-y-0' \n                : 'opacity-0 scale-y-0 -translate-y-2 pointer-events-none'\n            }`}\n          >\n            <div className=\"container mx-auto px-4 pb-4\">\n              {navItems.map((item, index) => (\n                <div \n                  key={item.label}\n                  className={`transition-all duration-300 ease-in-out ${\n                    isMenuOpen \n                      ? 'opacity-100 translate-y-0' \n                      : 'opacity-0 translate-y-2'\n                  }`}\n                  style={{ \n                    transitionDelay: isMenuOpen ? `${index * 50}ms` : '0ms' \n                  }}\n                >\n                  <button\n                    onClick={() => {\n                      if (item.path) {\n                        router.push(item.path);\n                        setIsMenuOpen(false);\n                      } else if (item.id) {\n                        handleMobileLinkClick(item.id);\n                      }\n                    }}\n                    className=\"block w-full text-left py-4 px-4 text-neutral-300 hover:text-white hover:bg-gray-800/50 transition-all duration-300 font-noto rounded-md\"\n                  >\n                    {item.label}\n                  </button>\n                  {index < navItems.length - 1 && (\n                    <div className=\"border-b border-gray-700/50 mx-2\"></div>\n                  )}\n                </div>\n              ))}\n              <div \n                className={`transition-all duration-300 ease-in-out ${\n                  isMenuOpen \n                    ? 'opacity-100 translate-y-0' \n                    : 'opacity-0 translate-y-2'\n                }`}\n                style={{ \n                  transitionDelay: isMenuOpen ? `${navItems.length * 50}ms` : '0ms' \n                }}\n              >\n                <div className=\"border-b border-gray-700/50 mx-2\"></div>\n                <button\n                  onClick={() => {\n                    handleAuthButtonClick();\n                    setIsMenuOpen(false);\n                  }}\n                  className=\"block w-full text-left py-4 px-4 transition-all duration-300 font-noto mt-2\"\n                >\n                  <span className=\"inline-block bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-bold py-2 px-4 rounded\">\n                    {isLoggedIn ? 'マイページ' : 'メンバーシップ'}\n                  </span>\n                </button>\n              </div>\n            </div>\n          </div>\n        </nav>\n\n        <div className=\"relative z-10 py-2 overflow-hidden isolate\">\n          <div\n            className=\"absolute inset-0 bg-gray-800/30 backdrop-blur-sm pointer-events-none\"\n            aria-hidden=\"true\"\n            style={{ backfaceVisibility: 'hidden', WebkitBackfaceVisibility: 'hidden' }}\n          />\n          <div className=\"container mx-auto px-6 md:px-12 relative\">\n            <div className=\"max-w-6xl mx-auto min-h-[44px]\">\n              {latestVotes.length > 0 && (\n                <div\n                  ref={animationRef}\n                  className=\"flex animate-scroll-left whitespace-nowrap text-white transform-gpu\"\n                  onAnimationIteration={handleAnimationIteration}\n                  style={{ willChange: applyWillChange ? 'transform' : undefined }}\n                >\n                  {latestVotes\n                    .filter(vote => vote.message && vote.message.trim() !== '')\n                    .map((vote, index) => (\n                      <div key={index} className=\"inline-flex items-center mx-8 flex-shrink-0\">\n                        <div className=\"text-left\">\n                          <p className=\"text-xs font-noto text-neutral-300\">\n                            {vote.voter_name || '匿名'}より\n                          </p>\n                          <p className=\"text-sm font-noto\">{vote.message}</p>\n                        </div>\n                      </div>\n                    ))}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </header>\n      <CookieConsent />\n    </>\n  );\n};\n\nexport default Header;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1348, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/components/Footer.tsx"],"sourcesContent":["import React from 'react';\n\ninterface FooterProps {\n  onShowPrivacyPolicy: () => void;\n}\n\nconst Footer: React.FC<FooterProps> = ({ onShowPrivacyPolicy }) => {\n  return (\n    <footer className=\"bg-black text-neutral-500 py-6 text-center text-xs\">\n      <div className=\"container mx-auto px-6\">\n        <button onClick={onShowPrivacyPolicy} className=\"hover:text-white transition-colors duration-300 mb-2\">\n          個人情報の取り扱いについて\n        </button>\n        <p>&copy; {new Date().getFullYear()} True Story. All Rights Reserved.</p>\n      </div>\n    </footer>\n  );\n};\n\nexport default Footer;"],"names":[],"mappings":";;;;;;AAMA,MAAM,SAAgC,CAAC,EAAE,mBAAmB,EAAE;IAC5D,qBACE,8OAAC;QAAO,WAAU;kBAChB,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAO,SAAS;oBAAqB,WAAU;8BAAuD;;;;;;8BAGvG,8OAAC;;wBAAE;wBAAQ,IAAI,OAAO,WAAW;wBAAG;;;;;;;;;;;;;;;;;;AAI5C;uCAEe","debugId":null}},
    {"offset": {"line": 1397, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/components/LoginErrorModal.tsx"],"sourcesContent":["import React from 'react';\nimport { XCircle } from 'lucide-react';\n\ntype LoginErrorModalProps = {\n  isOpen: boolean;\n  onClose: () => void;\n  message?: string;\n  onConfirm?: () => void;\n};\n\nconst LoginErrorModal: React.FC<LoginErrorModalProps> = ({ isOpen, onClose, message, onConfirm }) => {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-neutral-800 rounded-lg p-8 max-w-md mx-4 relative\">\n        <button\n          onClick={onClose}\n          className=\"absolute top-4 right-4 text-neutral-400 hover:text-white\"\n        >\n          <XCircle size={24} />\n        </button>\n        \n        <div className=\"text-center\">\n          <div className=\"mb-4\">\n            <XCircle className=\"w-16 h-16 text-red-500 mx-auto\" />\n          </div>\n          <h2 className=\"text-xl font-bold text-white mb-4\">\n            ログインエラー\n          </h2>\n          <p className=\"text-neutral-300 mb-6\">\n            {message}\n          </p>\n          <div className=\"space-y-3\">\n            <button\n              onClick={onConfirm || onClose}\n              className=\"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md transition duration-200\"\n            >\n              閉じる\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginErrorModal;\n"],"names":[],"mappings":";;;;;AACA;;;AASA,MAAM,kBAAkD,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE;IAC9F,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBACC,SAAS;oBACT,WAAU;8BAEV,cAAA,8OAAC,uNAAO;wBAAC,MAAM;;;;;;;;;;;8BAGjB,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,uNAAO;gCAAC,WAAU;;;;;;;;;;;sCAErB,8OAAC;4BAAG,WAAU;sCAAoC;;;;;;sCAGlD,8OAAC;4BAAE,WAAU;sCACV;;;;;;sCAEH,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCACC,SAAS,aAAa;gCACtB,WAAU;0CACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb;uCAEe","debugId":null}},
    {"offset": {"line": 1499, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/components/IndividualAuthForm.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Mail, X } from 'lucide-react';\nimport { supabase } from '../lib/supabaseClient';\nimport type { AuthFormData, AuthFormProps } from '../types/auth';\nimport {\n  generateYears,\n  generateMonths,\n  generateDays,\n  formatBirthDate,\n  calculatePasswordStrength,\n  handleGoogleAuth, // 追加\n  checkMemberExists, // 追加\n  robustSignOut // 追加\n} from '../utils/authUtils';\nimport { useRouter } from 'next/navigation'; // 変更\nimport LoginErrorModal from './LoginErrorModal'; // 追加\n\n// 新しいメンバーIDを生成する関数\nconst generateNewMemberId = async () => {\n  const ID_PREFIX = 'TS2025';\n  // 1. 'TS2025'で始まるIDの中から、最後に登録されたものを降順で取得する\n  const { data, error } = await supabase\n    .from('member_ids_view')\n    .select('member_id')\n    .like('member_id', `${ID_PREFIX}%`)\n    .order('member_id', { ascending: false })\n    .limit(1)\n    .maybeSingle(); // テーブルが空の場合もエラーにしない\n\n  if (error) {\n    console.error('Error fetching latest member_id:', error);\n    // エラーの場合はフォールバックとしてランダムなIDを生成\n    const timestamp = Date.now();\n    const random = Math.floor(Math.random() * 1000);\n    return `TS_ERR${timestamp}${random}`;\n  }\n\n  let newIdNumber = 1;\n  if (data && data.member_id) {\n    // IDの数字部分を抽出して、次の番号を計算\n    const lastIdNumber = parseInt(data.member_id.substring(ID_PREFIX.length), 10);\n    if (!isNaN(lastIdNumber)) {\n      newIdNumber = lastIdNumber + 1;\n    }\n  }\n\n  // 2. 新しいIDを生成 (TS2025 + 4桁の連番)\n  const paddedId = String(newIdNumber).padStart(4, '0');\n  return `${ID_PREFIX}${paddedId}`;\n};\n\nconst IndividualAuthForm: React.FC<AuthFormProps> = ({ onAuthSuccess }) => {\n  const [authMode, setAuthMode] = useState<'signin' | 'signup'>('signin');\n  const [showAdditionalInfo, setShowAdditionalInfo] = useState(false);\n  const [showEmailConfirmModal, setShowEmailConfirmModal] = useState(false);\n  const [authenticatedUser, setAuthenticatedUser] = useState<any>(null);\n  const [formData, setFormData] = useState<AuthFormData>({\n    email: '',\n    password: '',\n    lastName: '',\n    firstName: '',\n    birthYear: '',\n    birthMonth: '',\n    birthDay: '',\n    gender: '',\n    phoneNumber: '',\n    nickname: '',\n  });\n  const [googleUser, setGoogleUser] = useState<any>(null); // 追加\n  const [isCheckingMember, setIsCheckingMember] = useState(false); // 追加\n  const [showLoginErrorModal, setShowLoginErrorModal] = useState(false); // 追加\n  const [loginErrorMessage, setLoginErrorMessage] = useState(''); // 追加\n  const router = useRouter(); // 追加\n\n  const passwordStrength = calculatePasswordStrength(formData.password || '');\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    \n    if (name === 'email') {\n      const filteredValue = value.replace(/[^\\w@.-]/g, '');\n      setFormData(prev => ({ ...prev, [name]: filteredValue }));\n    } else if (name === 'password') {\n      const filteredValue = value.replace(/[^a-zA-Z0-9]/g, '');\n      setFormData(prev => ({ ...prev, [name]: filteredValue }));\n    } else if (name === 'phoneNumber') {\n      const filteredValue = value.replace(/[^0-9]/g, '');\n      setFormData(prev => ({ ...prev, [name]: filteredValue }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n  };\n\n  // Google認証処理 (AuthFormから移植)\n  useEffect(() => {\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      async (event, session) => {\n        console.log('IndividualAuthForm - 認証状態の変更:', event, session?.user?.id);\n        \n        if (event === 'SIGNED_IN' && session?.user) {\n          setIsCheckingMember(true);\n          setGoogleUser(session.user);\n\n          // タイムアウト処理\n          const timeoutId = setTimeout(() => {\n            if (isCheckingMember) {\n              console.warn('メンバーシップチェックがタイムアウトしました。');\n              robustSignOut();\n              setLoginErrorMessage('タイムアウトしました。もう一度お試しください。');\n              setShowLoginErrorModal(true);\n              setIsCheckingMember(false);\n              router.push('/users'); // タイムアウト時はユーザータイプ選択に戻る\n            }\n          }, 15000); // 15秒\n\n          try {\n            const memberExists = await checkMemberExists(session.user.id);\n            console.log('メンバーシップチェック結果:', memberExists);\n\n            if (memberExists) {\n              // 既存メンバーの場合\n              console.log('既存メンバーとしてログインします。');\n              onAuthSuccess(session.user, 'individual');\n            } else {\n              // 新規メンバーの場合\n              console.log('新規メンバー登録フローを開始します。');\n              setShowAdditionalInfo(true);\n            }\n          } catch (error) {\n            console.error('メンバーシップチェック中にエラー:', error);\n            robustSignOut();\n            setLoginErrorMessage('エラーが発生しました。もう一度お試しください。');\n            setShowLoginErrorModal(true);\n            router.push('/users');\n          } finally {\n            clearTimeout(timeoutId);\n            setIsCheckingMember(false);\n          }\n        }\n      }\n    );\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [onAuthSuccess, router]);\n\n  const handleGoogleSignIn = async () => {\n    await handleGoogleAuth();\n  };\n\n  // 初回ロード時の現在セッションチェックも追加 (AuthFormから移植)\n  useEffect(() => {\n    const checkCurrentSession = async () => {\n      try {\n        if (\n          typeof window !== 'undefined' &&\n          window.location.hash &&\n          (window.location.hash.includes('access_token') ||\n            window.location.hash.includes('error') ||\n            window.location.hash.includes('provider_token'))\n        ) {\n          console.log('IndividualAuthForm -  URLハッシュからの認証コールバック処理中...');\n          try {\n            const { error } = await supabase.auth.getSession();\n            if (error) {\n              console.warn('getSession error:', error);\n            }\n          } catch (e) {\n            console.error('Error calling getSession:', e);\n          }\n          try {\n            window.history.replaceState({}, document.title, window.location.pathname + window.location.search);\n          } catch (e) {\n            console.warn('Failed to replace history state', e);\n          }\n        }\n      } catch (e) {\n        console.error('Error handling auth callback hash:', e);\n      }\n\n      const { data: { session } } = await supabase.auth.getSession();\n      if (session?.user) {\n        const user = session.user;\n        const isGoogleAuth = user.app_metadata?.provider === 'google';\n        \n        if (isGoogleAuth) {\n          console.log('IndividualAuthForm - 既存のGoogleセッションが見つかりました:', user.id);\n          setIsCheckingMember(true);\n          \n          const existingMember = await checkMemberExists(user.id);\n          \n          if (!existingMember) {\n            console.log('IndividualAuthForm - 既存のGoogleセッションにメンバー記録が見つかりませんでした。追加情報フォームを表示します。');\n            setGoogleUser(user);\n            setFormData(prev => ({\n              ...prev,\n              email: user.email || '',\n              nickname: user.user_metadata?.full_name || user.user_metadata?.name || ''\n            }));\n            setShowAdditionalInfo(true);\n          } else if (existingMember.user_type === 'individual') {\n            console.log('IndividualAuthForm - 既存の個人メンバーが見つかりました。ログインを続行します。');\n            const userName = existingMember.nickname || `${existingMember.last_name} ${existingMember.first_name}`;\n            onAuthSuccess({ ...user, name: userName }, 'individual');\n            setIsCheckingMember(false); // Ensure loading state is cleared\n            return; // Important: Exit after calling onAuthSuccess\n          } else {\n            console.log('IndividualAuthForm - Google認証ユーザーは個人会員ではありません。/usersにリダイレクトします。');\n            await robustSignOut();\n            router.push('/users');\n          }\n          \n          setIsCheckingMember(false);\n        }\n      }\n    };\n\n    checkCurrentSession();\n  }, [onAuthSuccess, router]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    try {\n      if (authMode === 'signin') {\n        await handleSignIn(e);\n      } else {\n        await handleSignUp(e);\n      }\n    } catch (error) {\n      console.error('Form submission error:', error);\n      setLoginErrorMessage('フォームの送信中にエラーが発生しました。');\n      setShowLoginErrorModal(true);\n    }\n  };\n\n  const handleSignUp = async (e: React.FormEvent) => {\n    e.preventDefault();\n    try {\n      const { data, error } = await supabase.auth.signUp({\n        email: formData.email,\n        password: formData.password ?? '',\n      });\n\n      if (error) {\n        console.error('Signup error:', error.message);\n        setLoginErrorMessage(error.message);\n        setShowLoginErrorModal(true);\n        return;\n      }\n\n      if (data.user) {\n        setAuthenticatedUser(data.user);\n        setShowEmailConfirmModal(true);\n      }\n    } catch (error) {\n      console.error('Signup process error:', error);\n      setLoginErrorMessage('サインアップ処理中に予期せぬエラーが発生しました。');\n      setShowLoginErrorModal(true);\n    }\n  };\n\n  const handleSignIn = async (e: React.FormEvent) => {\n    e.preventDefault();\n    try {\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email: formData.email,\n        password: formData.password ?? '',\n      });\n\n      if (error) {\n        console.error('Signin error:', error.message);\n        setLoginErrorMessage(error.message);\n        setShowLoginErrorModal(true);\n        return;\n      }\n\n      if (data.user) {\n        const memberExists = await checkMemberExists(data.user.id);\n        if (memberExists) {\n          onAuthSuccess(data.user, 'individual');\n        } else {\n          // メール認証は済んでいるが、メンバー情報がない場合\n          setAuthenticatedUser(data.user);\n          setShowAdditionalInfo(true);\n        }\n      }\n    } catch (error) {\n      console.error('Signin process error:', error);\n      setLoginErrorMessage('サインイン処理中に予期せぬエラーが発生しました。');\n      setShowLoginErrorModal(true);\n    }\n  };\n\n  const handleBackToSelection = () => {\n    router.push('/users');\n  };\n\n  const handleAdditionalInfoSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    const maxAttempts = 5;\n    for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n      try {\n        if (!googleUser && !authenticatedUser) {\n          throw new Error('認証されたユーザー情報が見つかりません。');\n        }\n        const targetUser = googleUser || authenticatedUser;\n\n        const birthDate = formatBirthDate(formData.birthYear, formData.birthMonth, formData.birthDay);\n        const memberId = await generateNewMemberId();\n\n        const { error: insertError } = await supabase.from('individual_members').insert({\n          member_id: memberId,\n          auth_user_id: targetUser.id,\n          last_name: formData.lastName,\n          first_name: formData.firstName,\n          birth_date: birthDate,\n          gender: formData.gender,\n          email: targetUser.email,\n          phone_number: formData.phoneNumber,\n          nickname: formData.nickname,\n        });\n\n        if (insertError) {\n          if (insertError.code === '23505' && attempt < maxAttempts) {\n            console.warn(`Attempt ${attempt}: Duplicate member_id ${memberId}. Retrying...`);\n            await new Promise(resolve => setTimeout(resolve, Math.random() * 200 + 100));\n            continue; // Go to next attempt\n          }\n          throw insertError;\n        }\n\n        // --- SUCCESS ---\n        const userName = formData.nickname || `${formData.lastName || ''} ${formData.firstName || ''}`.trim();\n        setShowAdditionalInfo(false);\n        setGoogleUser(null);\n        setAuthenticatedUser(null);\n\n        const pendingSubmission = localStorage.getItem('pendingStorySubmission');\n        if (pendingSubmission) {\n          localStorage.removeItem('pendingStorySubmission');\n          router.push('/#truestoryform');\n        } else {\n          onAuthSuccess(targetUser, 'individual');\n        }\n        return; // Exit function on success\n\n      } catch (err) {\n        console.error(`Attempt ${attempt} failed:`, err);\n        if (attempt >= maxAttempts) {\n          // If all attempts fail, show a final error\n          setLoginErrorMessage('メンバーの登録に失敗しました。時間をおいて再度お試しください。');\n          setShowLoginErrorModal(true);\n        }\n      }\n    }\n  };\n\n  const handleCancelGoogleAuth = async () => {\n    await robustSignOut();\n    setShowAdditionalInfo(false);\n    setGoogleUser(null);\n    router.push('/users');\n  };\n\n  const closeEmailConfirmModal = () => {\n    setShowEmailConfirmModal(false);\n    setFormData({\n      email: '',\n      password: '',\n      lastName: '',\n      firstName: '',\n      birthYear: '',\n      birthMonth: '',\n      birthDay: '',\n      gender: '',\n      phoneNumber: '',\n      nickname: '',\n    });\n    setAuthMode('signin');\n  };\n\n  if (isCheckingMember) {\n    return (\n      <div className=\"max-w-md mx-auto p-8\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-white mb-4\">認証確認中...</h2>\n          <p className=\"text-neutral-300 mb-6\">しばらくお待ちください</p>\n          <div className=\"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto\"></div>\n          <p className=\"text-xs text-neutral-400 mt-4\">5秒以上かかる場合は自動的にリセットされます</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (showEmailConfirmModal) {\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n        <div className=\"bg-neutral-800 rounded-lg p-8 max-w-md mx-4 relative\">\n          <button\n            onClick={closeEmailConfirmModal}\n            className=\"absolute top-4 right-4 text-neutral-400 hover:text-white\"\n          >\n            <X size={20} />\n          </button>\n          \n          <div className=\"text-center\">\n            <div className=\"mb-4\">\n              <Mail className=\"w-16 h-16 text-green-500 mx-auto\" />\n            </div>\n            <h2 className=\"text-xl font-bold text-white mb-4\">\n              確認メールを送信しました\n            </h2>\n            <p className=\"text-neutral-300 mb-6\">\n              {formData.email} に確認メールを送信しました。<br />\n              メール内のリンクをクリックしてアカウントを有効化してから、再度ログインしてください。\n            </p>\n            <div className=\"space-y-3\">\n              <button\n                onClick={closeEmailConfirmModal}\n                className=\"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition duration-200\"\n              >\n                ログイン画面に戻る\n              </button>\n              <p className=\"text-xs text-neutral-400\">\n                メールが届かない場合は、迷惑メールフォルダもご確認ください。\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (showAdditionalInfo) {\n    return (\n      <div className=\"max-w-md mx-auto\">\n        <div className=\"mb-6\">\n          <h3 className=\"text-xl font-bold text-white mb-2\">追加情報の入力</h3>\n          <p className=\"text-neutral-300 text-sm\">\n            ログインが完了しました。会員登録を完了するために、以下の情報を入力してください。\n          </p>\n        </div>\n\n        <form onSubmit={handleAdditionalInfoSubmit} className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n                苗字 <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"lastName\"\n                value={formData.lastName}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n                required\n                placeholder=\"山田\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n                名前 <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"firstName\"\n                value={formData.firstName}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n                required\n                placeholder=\"太郎\"\n              />\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              ニックネーム <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              name=\"nickname\"\n              value={formData.nickname}\n              onChange={handleInputChange}\n              className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n              required\n              placeholder=\"たろう\"\n            />\n            <p className=\"text-xs text-neutral-400 mt-2\">サイト上で表示される名前です</p>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              生年月日 <span className=\"text-red-500\">*</span>\n            </label>\n            <div className=\"grid grid-cols-3 gap-2\">\n              <select\n                name=\"birthYear\"\n                value={formData.birthYear}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n                required\n              >\n                <option value=\"\">年</option>\n                {generateYears().map(year => (\n                  <option key={year} value={year}>{year}年</option>\n                ))}\n              </select>\n              \n              <select\n                name=\"birthMonth\"\n                value={formData.birthMonth}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n                required\n              >\n                <option value=\"\">月</option>\n                {generateMonths().map(month => (\n                  <option key={month} value={month}>{month}月</option>\n                ))}\n              </select>\n              \n              <select\n                name=\"birthDay\"\n                value={formData.birthDay}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n                required\n                disabled={!formData.birthYear || !formData.birthMonth}\n              >\n                <option value=\"\">日</option>\n                {generateDays(formData.birthYear, formData.birthMonth).map(day => (\n                  <option key={day} value={day}>{day}日</option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              性別 <span className=\"text-red-500\">*</span>\n            </label>\n            <select\n              name=\"gender\"\n              value={formData.gender}\n              onChange={handleInputChange}\n              className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n              required\n            >\n              <option value=\"\">選択してください</option>\n              <option value=\"男性\">男性</option>\n              <option value=\"女性\">女性</option>\n              <option value=\"その他\">その他</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              携帯電話番号 <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"tel\"\n              name=\"phoneNumber\"\n              value={formData.phoneNumber}\n              onChange={handleInputChange}\n              className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n              required\n              placeholder=\"09012345678\"\n              pattern=\"[0-9]*\"\n              inputMode=\"numeric\"\n            />\n          </div>\n\n          <div className=\"flex gap-4 pt-2\">\n            <button\n              type=\"button\"\n              onClick={handleCancelGoogleAuth}\n              className=\"flex-1 bg-neutral-700 hover:bg-neutral-600 text-white px-5 py-3 rounded-md text-base transition duration-200\"\n            >\n              キャンセル\n            </button>\n            <button\n              type=\"submit\"\n              className=\"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-5 py-3 rounded-md text-base transition duration-200\"\n            >\n              登録を完了する\n            </button>\n          </div>\n        </form>\n      </div>\n    );\n  }\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {/* Googleログインボタンをメールフォームの上に移動 */}\n      <button\n        type=\"button\"\n        onClick={handleGoogleAuth}\n        className=\"w-full bg-white border border-gray-300 hover:bg-gray-50 text-gray-800 flex items-center justify-center gap-3 px-5 py-3 rounded-md transition duration-200\"\n      >\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 24 24\">\n          <path fill=\"#4285F4\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" />\n          <path fill=\"#34A853\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" />\n          <path fill=\"#FBBC05\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" />\n          <path fill=\"#EA4335\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" />\n        </svg>\n        <span className=\"text-base\">Googleでログイン</span>\n      </button>\n\n      <div className=\"relative my-6\">\n        <div className=\"absolute inset-0 flex items-center\">\n          <div className=\"w-full border-t border-neutral-600\"></div>\n        </div>\n        <div className=\"relative flex justify-center text-sm\">\n          <span className=\"px-4 bg-neutral-900 text-neutral-400\">または</span>\n        </div>\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n          メールアドレス <span className=\"text-red-500\">*</span>\n        </label>\n        <input\n          type=\"email\"\n          name=\"email\"\n          value={formData.email}\n          onChange={handleInputChange}\n          className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n          required\n          placeholder=\"example@email.com\"\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n          パスワード <span className=\"text-red-500\">*</span>\n        </label>\n        <input\n          type=\"password\"\n          name=\"password\"\n          value={formData.password}\n          onChange={handleInputChange}\n          className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n          required\n          minLength={6}\n          placeholder=\"英数字6文字以上\"\n        />\n        \n        {formData.password && authMode === 'signup' && (\n          <div className=\"mt-3\">\n            <div className=\"flex w-full h-2 bg-neutral-600 rounded-full overflow-hidden\">\n              <div \n                className={`h-full ${\n                  passwordStrength.strength === 0 ? 'w-1/3 bg-red-500' : \n                  passwordStrength.strength === 1 ? 'w-2/3 bg-yellow-500' : \n                  'w-full bg-green-500'\n                }`} \n              />\n            </div>\n            <p className=\"text-xs text-neutral-300 mt-2\">\n              {passwordStrength.message}\n            </p>\n          </div>\n        )}\n      </div>\n\n      {authMode === 'signup' && (\n        <>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n                苗字 <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"lastName\"\n                value={formData.lastName}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n                required\n                placeholder=\"山田\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n                名前 <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"firstName\"\n                value={formData.firstName}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n                required\n                placeholder=\"太郎\"\n              />\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              ニックネーム <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              name=\"nickname\"\n              value={formData.nickname}\n              onChange={handleInputChange}\n              className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n              required\n              placeholder=\"たろう\"\n            />\n            <p className=\"text-xs text-neutral-400 mt-2\">サイト上で表示される名前です</p>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              生年月日 <span className=\"text-red-500\">*</span>\n            </label>\n            <div className=\"grid grid-cols-3 gap-2\">\n              <select\n                name=\"birthYear\"\n                value={formData.birthYear}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n                required\n              >\n                <option value=\"\">年</option>\n                {generateYears().map(year => (\n                  <option key={year} value={year}>{year}年</option>\n                ))}\n              </select>\n              \n              <select\n                name=\"birthMonth\"\n                value={formData.birthMonth}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n                required\n              >\n                <option value=\"\">月</option>\n                {generateMonths().map(month => (\n                  <option key={month} value={month}>{month}月</option>\n                ))}\n              </select>\n              \n              <select\n                name=\"birthDay\"\n                value={formData.birthDay}\n                onChange={handleInputChange}\n                className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n                required\n                disabled={!formData.birthYear || !formData.birthMonth}\n              >\n                <option value=\"\">日</option>\n                {generateDays(formData.birthYear, formData.birthMonth).map(day => (\n                  <option key={day} value={day}>{day}日</option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              性別 <span className=\"text-red-500\">*</span>\n            </label>\n            <select\n              name=\"gender\"\n              value={formData.gender}\n              onChange={handleInputChange}\n              className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white focus:border-green-500 focus:outline-none\"\n              required\n            >\n              <option value=\"\">選択してください</option>\n              <option value=\"男性\">男性</option>\n              <option value=\"女性\">女性</option>\n              <option value=\"その他\">その他</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-300 mb-2\">\n              携帯電話番号 <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"tel\"\n              name=\"phoneNumber\"\n              value={formData.phoneNumber}\n              onChange={handleInputChange}\n              className=\"w-full bg-neutral-700 border border-neutral-600 rounded-md p-3 text-white placeholder-neutral-400 focus:border-green-500 focus:outline-none\"\n              required\n              placeholder=\"09012345678\"\n              pattern=\"[0-9]*\"\n              inputMode=\"numeric\"\n            />\n          </div>\n        </>\n      )}\n\n      <button\n        type=\"submit\"\n        className=\"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-5 py-3 rounded-md flex items-center justify-center gap-2 text-base transition duration-200\"\n      >\n        <Mail size={18} />\n        {authMode === 'signin' ? 'ログイン' : '登録する'}\n      </button>\n\n      <div className=\"text-center\">\n        <button\n          type=\"button\"\n          onClick={() => setAuthMode(authMode === 'signin' ? 'signup' : 'signin')}\n          className=\"text-blue-400 hover:text-blue-300 text-sm\"\n        >\n          {authMode === 'signin' ? 'アカウントをお持ちでない方はこちら' : 'すでにアカウントをお持ちの方はこちら'}\n        </button>\n      </div>\n\n      <LoginErrorModal\n        isOpen={showLoginErrorModal}\n        onClose={() => setShowLoginErrorModal(false)}\n        message={loginErrorMessage}\n        onConfirm={() => setShowLoginErrorModal(false)}\n      />\n    </form>\n  );\n};\n\nexport default IndividualAuthForm;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3100, "column": 0}, "map": {"version":3,"sources":["file:///Users/tunotunofilms/Downloads/code/True%20Story/src/app/users/member/%5BuserId%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport Link from 'next/link';\nimport { useRouter, useParams } from 'next/navigation';\nimport { Session } from '@supabase/supabase-js';\nimport { supabase } from '../../../../lib/supabaseClient';\nimport { robustSignOut, checkMemberExists } from '../../../../utils/authUtils';\nimport Header from '../../../../components/Header';\nimport Footer from '../../../../components/Footer';\nimport PrivacyPolicy from '../../../../components/PrivacyPolicy';\nimport IndividualAuthForm from '../../../../components/IndividualAuthForm';\nimport { useAuth } from '../../../../contexts/AuthContext';\n\ninterface User {\n  email: string;\n  name?: string;\n  userType?: 'individual' | 'sponsor';\n  memberData?: any;\n}\n\nconst MemberPage: React.FC = () => {\n  const [showPrivacyPolicy, setShowPrivacyPolicy] = useState(false);\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [showMinimalLoader, setShowMinimalLoader] = useState(false);\n  const [voteHistory, setVoteHistory] = useState<any[]>([]);\n  const [isLoadingVotes, setIsLoadingVotes] = useState(false);\n  const [submittedStory, setSubmittedStory] = useState<{ content: string; submitted_at: string; } | null>(null);\n  const [isLoadingStory, setIsLoadingStory] = useState(false);\n  const router = useRouter();\n  const params = useParams();\n  const userId = params?.userId as string;\n  const isSigningOut = useRef(false);\n  const { session, loading: authLoading } = useAuth();\n  const [subtitle, setSubtitle] = useState('ログインまたは新規登録');\n\n  useEffect(() => {\n    const pendingSubmission = localStorage.getItem('pendingStorySubmission');\n    if (pendingSubmission) {\n      setSubtitle('ログインまたは新規登録して物語の送信を完了する');\n    }\n  }, []);\n\n  const fetchVoteHistory = async (authUserId: string) => {\n    setIsLoadingVotes(true);\n    try {\n      const { data: member, error: memberError } = await supabase\n        .from('individual_members')\n        .select('phone_number')\n        .eq('auth_user_id', authUserId)\n        .single();\n\n      if (memberError || !member) {\n        console.log('auth_user_id に対応する個人会員が見つかりませんでした:', authUserId);\n        setVoteHistory([]);\n        return;\n      }\n\n      const { data: votes, error } = await supabase\n        .from('votes')\n        .select(`\n          id,\n          artist_id,\n          message,\n          created_at,\n          artists (\n            id,\n            name,\n            image_url\n          )\n        `)\n        .eq('phone_number', member.phone_number)\n        .order('created_at', { ascending: false });\n\n      if (error) {\n        console.error('投票履歴の取得中にエラーが発生しました:', error);\n        return;\n      }\n\n      setVoteHistory(votes || []);\n    } catch (error) {\n      console.error('fetchVoteHistory でエラーが発生しました:', error);\n    } finally {\n      setIsLoadingVotes(false);\n    }\n  };\n\n  const fetchSubmittedStory = async (authUserId: string) => {\n    setIsLoadingStory(true);\n    try {\n      const { data: storyData, error: storyError } = await supabase\n        .from('stories')\n        .select('file_path, created_at')\n        .eq('user_id', authUserId)\n        .order('created_at', { ascending: false })\n        .limit(1)\n        .single();\n\n      if (storyError || !storyData) {\n        if (storyError && storyError.code !== 'PGRST116') {\n          console.error('Error fetching story metadata:', storyError);\n        }\n        setSubmittedStory(null);\n        return;\n      }\n\n      const { data: blobData, error: downloadError } = await supabase.storage\n        .from('stories')\n        .download(storyData.file_path);\n\n      if (downloadError) {\n        console.error('Error downloading story content:', downloadError);\n        setSubmittedStory(null);\n        return;\n      }\n\n      const storyContent = await blobData.text();\n      setSubmittedStory({ content: storyContent, submitted_at: storyData.created_at });\n\n    } catch (error) {\n      console.error('Error in fetchSubmittedStory:', error);\n    } finally {\n      setIsLoadingStory(false);\n    }\n  };\n\n  const [hasCheckedStatus, setHasCheckedStatus] = useState(false);\n\n  useEffect(() => {\n    if (authLoading) {\n      console.log('AuthContext はまだロード中です。処理を中断します。');\n      return;\n    }\n\n    if (!hasCheckedStatus) {\n      let loadingTimeout: NodeJS.Timeout;\n      let minimalLoaderTimeout: NodeJS.Timeout;\n\n      minimalLoaderTimeout = setTimeout(() => {\n        setShowMinimalLoader(true);\n      }, 500);\n\n      const checkUserStatus = async () => {\n        try {\n          loadingTimeout = setTimeout(() => {\n            console.log('Loading timeout - ログインフォームまたはリダイレクトを強制的に実行します。');\n            setIsLoading(false);\n            setShowMinimalLoader(false);\n            setUser(null);\n            setHasCheckedStatus(true);\n          }, 3000);\n\n          if (!session?.user) {\n            console.log('checkUserStatus: セッションユーザーが見つかりません。ログインフォームを表示します。');\n            setUser(null);\n            setIsLoading(false);\n            setShowMinimalLoader(false);\n          } else {\n            const currentUser = session.user;\n            console.log('checkUserStatus: セッションユーザーが見つかりました。', currentUser.id);\n\n            if (!userId || userId !== currentUser.id) {\n              setIsLoading(false);\n              setShowMinimalLoader(false);\n              router.push(`/users/member/${currentUser.id}`);\n              return;\n            }\n\n            console.log('checkUserStatus: URLのユーザーIDがセッションのユーザーと一致しました。個々のメンバーデータを取得中です。');\n            const { data: individualMember } = await supabase\n              .from('individual_members')\n              .select('*')\n              .eq('auth_user_id', currentUser.id)\n              .maybeSingle();\n\n            if (individualMember) {\n              const userName = individualMember.nickname || `${individualMember.last_name} ${individualMember.first_name}`;\n              setUser({\n                email: currentUser.email || '',\n                name: userName,\n                userType: 'individual',\n                memberData: individualMember\n              });\n              await fetchVoteHistory(currentUser.id);\n              await fetchSubmittedStory(currentUser.id);\n              setIsLoading(false);\n              setShowMinimalLoader(false);\n            } else {\n              const isGoogleAuth = currentUser.app_metadata?.provider === 'google';\n              if (isGoogleAuth) {\n                console.log('checkUserStatus: Google認証済みですが、個人会員ではありません。IndividualAuthForm のレンダリングを許可します。');\n                setUser(null);\n                setIsLoading(false);\n                setShowMinimalLoader(false);\n              } else {\n                console.log('checkUserStatus: 認証済みですが、個人会員ではありません (Google Auth ではない)。ユーザータイプ選択にリダイレクトします。');\n                setIsLoading(false);\n                setShowMinimalLoader(false);\n                router.push('/users');\n                return;\n              }\n            }\n          }\n          clearTimeout(loadingTimeout);\n          clearTimeout(minimalLoaderTimeout);\n          setHasCheckedStatus(true);\n        } catch (error) {\n          console.error('checkUserStatus: Session check error:', error);\n          clearTimeout(loadingTimeout);\n          clearTimeout(minimalLoaderTimeout);\n          setIsLoading(false);\n          setShowMinimalLoader(false);\n          setUser(null);\n          setHasCheckedStatus(true);\n        }\n      };\n\n      checkUserStatus();\n    }\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      async (event: string, currentSession: Session | null) => {\n        if (event === 'SIGNED_OUT') {\n          console.log('Auth state change: サインアウト済みです。');\n          if (isSigningOut.current) {\n            isSigningOut.current = false;\n            return;\n          }\n          setUser(null);\n          setIsLoading(false);\n          setShowMinimalLoader(false);\n          setHasCheckedStatus(false);\n        } else if (event === 'SIGNED_IN' && currentSession?.user) {\n          console.log('Auth state change: サインイン済みです。', currentSession.user.id);\n          router.push(`/users/member/${currentSession.user.id}`);\n        }\n      }\n    );\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [router, session, authLoading, userId, hasCheckedStatus]);\n\n  const openPrivacyPolicy = () => setShowPrivacyPolicy(true);\n  const closePrivacyPolicy = () => setShowPrivacyPolicy(false);\n\n  const handleSignOut = async () => {\n    console.log('handleSignOut が呼び出されました。');\n    isSigningOut.current = true;\n    await robustSignOut();\n    router.push('/');\n  };\n\n  const handleAuthSuccess = (user: { id: string; [key: string]: any }, userType: 'individual' | 'sponsor') => {\n    console.log('IndividualMyPage - handleAuthSuccess が呼び出されました。 user.id:', user.id);\n    \n    if (userType !== 'individual') {\n      console.warn(`予期しないユーザータイプ: ${userType}。スポンサーページにリダイレクトします。`);\n      router.push(`/users/sponsor/${user.id}`);\n      return;\n    }\n\n    const pendingSubmission = localStorage.getItem('pendingStorySubmission');\n    if (pendingSubmission) {\n      localStorage.removeItem('pendingStorySubmission');\n      router.push('/#truestoryform');\n      // ページ遷移後に状態を更新するために、再チェックを促す\n      setHasCheckedStatus(false); \n      return;\n    }\n\n    if (user.id) {\n      console.log('handleAuthSuccess: ユーザーIDページに遷移します。', user.id);\n      router.push(`/users/member/${user.id}`);\n      // ページ遷移後に状態を更新するために、再チェックを促す\n      setHasCheckedStatus(false); \n    } else {\n      console.error('handleAuthSuccess: authUserId が見つかりません。');\n      // エラーが発生した場合でも、ホームページにリダイレクトするなどのフォールバック\n      router.push('/');\n    }\n  };\n\n  if (isLoading || authLoading) {\n    console.log('Rendering: 読み込み状態です。', { isLoading, authLoading, sessionExists: !!session?.user, userExists: !!user });\n    return (\n      <div className=\"min-h-screen bg-neutral-900 text-white relative\">\n        <Header />\n        <main className=\"container mx-auto px-4 py-16\">\n          <div className=\"text-center\">\n            <h1 className=\"text-4xl font-bold font-noto mb-8\">マイページ</h1>\n            {showMinimalLoader && (\n              <div className=\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto\"></div>\n            )}\n            <p className=\"text-neutral-300 mt-4\">ユーザー情報を読み込み中...</p>\n          </div>\n        </main>\n        <div className=\"absolute bottom-32 right-20\">\n          <button\n            onClick={handleSignOut}\n            className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md transition duration-300 text-sm\"\n          >\n            強制ログアウト\n          </button>\n        </div>\n        <Footer onShowPrivacyPolicy={openPrivacyPolicy} />\n      </div>\n    );\n  }\n\n  if (!session?.user) {\n    console.log('Rendering: ログインしていません。ログインフォームを表示します。');\n    return (\n      <div className=\"min-h-screen bg-neutral-900 text-white\">\n        <Header />\n        <main className=\"container mx-auto px-4 py-16\">\n          <div className=\"max-w-md mx-auto\">\n            <div className=\"text-center mb-8\">\n              <h1 className=\"text-4xl font-bold font-noto mb-6\">メンバーシップ</h1>\n              <p className=\"text-neutral-300\">{subtitle}</p>\n              <div className=\"mt-4\">\n                <Link href=\"/users\" className=\"text-sm text-blue-400 hover:text-blue-300 transition-colors\">\n                  アカウントの種類選択に戻る\n                </Link>\n              </div>\n              <div className=\"mt-8 text-left text-neutral-300 border-t border-neutral-700 pt-6\">\n                  <h3 className=\"text-lg font-semibold text-white mb-4 text-center\">特典</h3>\n                  <ul className=\"space-y-2 list-disc list-inside text-sm text-neutral-400 pb-6 border-b border-neutral-700\">\n                    <li>最新情報や進捗情報の通知</li>\n                    <li>過去の投稿や投票のログ表示</li>\n                    <li>メンバーシップのみの限定情報やコンテンツ</li>\n                    <li>出演者やアーティストからの特別メッセージ</li>\n                    <li>メールマガジンの配信 (仮)</li>\n                  </ul>\n                </div>\n            </div>\n            <IndividualAuthForm onAuthSuccess={handleAuthSuccess} />\n          </div>\n        </main>\n        <Footer onShowPrivacyPolicy={openPrivacyPolicy} />\n        {showPrivacyPolicy && <PrivacyPolicy onClose={closePrivacyPolicy} />}\n      </div>\n    );\n  }\n\n  if (session?.user && !user && session.user.app_metadata?.provider === 'google') {\n    console.log('Rendering: Google認証ユーザー、個々のメンバーデータがありません。追加情報フォームを表示中です。');\n    return (\n      <div className=\"min-h-screen bg-neutral-900 text-white\">\n        <Header />\n        <main className=\"container mx-auto px-4 py-16\">\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-4xl font-bold font-noto mb-8\">個人会員登録</h1>\n            <p className=\"text-neutral-300\">追加情報を入力してください</p>\n          </div>\n          <IndividualAuthForm onAuthSuccess={handleAuthSuccess} />\n        </main>\n        <Footer onShowPrivacyPolicy={openPrivacyPolicy} />\n        {showPrivacyPolicy && <PrivacyPolicy onClose={closePrivacyPolicy} />}\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"min-h-screen bg-neutral-900 text-white\">\n      <Header />\n      \n      <main className=\"container mx-auto px-4 py-16\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold font-noto mb-8\">メンバーシップ マイページ</h1>\n        </div>\n          \n        {user && (\n          <div>\n            <div className=\"text-center mb-8\">\n              <p className=\"text-lg mb-2\">ようこそ、{user.name}さん\n                <span className=\"ml-2 px-2 py-1 bg-blue-600 text-xs rounded\">個人</span>\n              </p>\n              <p className=\"text-sm my-4\">マイページは順次アップデート予定です。</p>\n              <p className=\"text-neutral-400\">メンバーシップID: <span className=\"text-lg font-bold text-indigo-400 tracking-wide\">{user.memberData.member_id}</span></p>\n            </div>\n\n            <div className=\"max-w-2xl mx-auto\">\n              <div className=\"bg-neutral-800 rounded-lg p-6 mb-6\">\n                <h3 className=\"text-xl font-bold mb-4 text-green-400\">メンバーシップ情報</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <p className=\"text-sm text-neutral-400\">お名前</p>\n                    <p className=\"font-medium\">{user.memberData.last_name} {user.memberData.first_name}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-neutral-400\">ニックネーム</p>\n                    <p className=\"font-medium\">{user.memberData.nickname}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-neutral-400\">メールアドレス</p>\n                    <p className=\"font-medium\">{user.email}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-neutral-400\">電話番号</p>\n                    <p className=\"font-medium\">{user.memberData.phone_number}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-neutral-400\">生年月日</p>\n                    <p className=\"font-medium\">{user.memberData.birth_date ? new Date(user.memberData.birth_date).toLocaleDateString('ja-JP') : '未設定'}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-neutral-400\">性別</p>\n                    <p className=\"font-medium\">{user.memberData.gender || '未設定'}</p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-neutral-800 rounded-lg p-6 mb-6\">\n                <h3 className=\"text-xl font-bold mb-4 text-purple-400\">あなたが投稿した実話</h3>\n                {isLoadingStory ? (\n                  <div className=\"text-center py-4\">\n                    <div className=\"w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-2\"></div>\n                    <p className=\"text-sm text-neutral-400\">読み込み中...</p>\n                  </div>\n                ) : submittedStory ? (\n                  <div>\n                    <p className=\"text-xs text-neutral-400 mb-2\">\n                      投稿日時: {new Date(submittedStory.submitted_at).toLocaleString('ja-JP')}\n                    </p>\n                    <div className=\"bg-neutral-900 p-4 rounded-md max-h-60 overflow-y-auto\">\n                      <p className=\"text-neutral-200 whitespace-pre-wrap\">{submittedStory.content}</p>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <p className=\"text-neutral-400 mb-2\">まだ実話が投稿されていません</p>\n                    <p className=\"text-sm text-neutral-500\">トップページからあなたの物語を投稿してみましょう！</p>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-neutral-800 rounded-lg p-6\">\n                <h3 className=\"text-xl font-bold mb-4 text-blue-400\">アーティストの投票履歴</h3>\n                \n                {isLoadingVotes ? (\n                  <div className=\"text-center py-4\">\n                    <div className=\"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-2\"></div>\n                    <p className=\"text-sm text-neutral-400\">読み込み中...</p>\n                  </div>\n                ) : voteHistory.length > 0 ? (\n                  <div>\n                    <div className=\"mb-4 p-3 bg-neutral-700 rounded-lg\">\n                      <p className=\"text-sm text-neutral-400\">総投票回数</p>\n                      <p className=\"text-2xl font-bold text-blue-400\">{voteHistory.length}回</p>\n                    </div>\n                    \n                    <div className=\"space-y-3 max-h-64 overflow-y-auto\">\n                      <h4 className=\"text-sm font-medium text-neutral-300 border-b border-neutral-600 pb-2\">投票履歴</h4>\n                      {voteHistory.map((vote) => (\n                        <div key={vote.id} className=\"bg-neutral-700 rounded-lg p-3\">\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            {vote.artists?.image_url && (\n                              <img \n                                src={vote.artists.image_url} \n                                alt={vote.artists.name}\n                                className=\"w-8 h-8 rounded-full object-cover\"\n                              />\n                            )}\n                            <div className=\"flex-1\">\n                              <p className=\"font-medium text-white\">{vote.artists?.name || '不明なアーティスト'}</p>\n                              <p className=\"text-xs text-neutral-400\">\n                                {new Date(vote.created_at).toLocaleDateString('ja-JP', {\n                                  year: 'numeric',\n                                  month: 'short',\n                                  day: 'numeric',\n                                  hour: '2-digit',\n                                  minute: '2-digit'\n                                })}\n                              </p>\n                            </div>\n                          </div>\n                          {vote.message && (\n                            <div className=\"mt-2 p-2 bg-neutral-600 rounded text-sm\">\n                              <p className=\"text-neutral-300\">\"{vote.message}\"</p>\n                            </div>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <p className=\"text-neutral-400 mb-2\">coming soon</p>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"text-center mt-8\">\n              <button\n                onClick={handleSignOut}\n                className=\"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-md transition duration-300\"\n              >\n                ログアウト\n              </button>\n            </div>\n          </div>\n        )}\n      </main>\n      \n      <Footer onShowPrivacyPolicy={openPrivacyPolicy} />\n      \n      {showPrivacyPolicy && <PrivacyPolicy onClose={closePrivacyPolicy} />}\n    </div>\n  );\n};\n\nexport default MemberPage;\n"],"names":[],"mappings":"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","debugId":null}}]
}